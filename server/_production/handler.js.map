{"version":3,"sources":["../app/handler.js"],"names":[],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA,IAAM,OAAO,gBAAM,UAAN,kBAAb;;AAEA,IAAM,SAAS,SAAT,MAAS,CAAC,GAAD,EAAM,IAAN,EAAe;AAC1B,SAAK,aAAL,CAAmB,UAAC,GAAD,EAAM,GAAN,EAAc;AAC7B,YAAI,KAAJ,CAAU,kBAAI,IAAJ,CAAV,EAAqB,UAAC,GAAD,EAAM,MAAN,EAAiB;AAClC,kCAAU,GAAV,EAAe,MAAf;AACA,gBAAI,OAAJ;AACH,SAHD;AAIH,KALD;AAMH,CAPD;;kBASe;;;AAEX,mBAFW,2BAEK,GAFL,EAEU,GAFV,EAEe;AACtB,eAAO,GAAP,EAAY,eAAZ;AACH,KAJU;;;AAMX,mBANW,2BAMK,GANL,EAMU,GANV,EAMe;AACtB,eAAO,GAAP,EAAY,eAAZ;AACH,KARU;;;AAUX,iBAVW,yBAUG,GAVH,EAUQ,GAVR,EAUa;AACpB,YAAI,OAAO,IAAI,IAAf;AACA,YAAI,SAAS,CAAC,KAAK,IAAN,EAAY,KAAK,OAAjB,EAA0B,KAAK,QAA/B,CAAb;;AAEA,aAAK,aAAL,CAAmB,UAAC,GAAD,EAAM,GAAN,EAAc;AAC7B,gBAAI,KAAJ,CAAU,kBAAI,aAAd,EAA6B,MAA7B,EAAqC,UAAC,GAAD,EAAM,MAAN,EAAiB;AAClD,sCAAU,GAAV,EAAe,MAAf;AACA,oBAAI,OAAJ;AACH,aAHD;AAIH,SALD;AAMH;AApBU,C","file":"handler.js","sourcesContent":["import mysql from \"mysql\"\nimport Map from \"./db/mapping\"\nimport Conf from \"./db/config\"\nimport { jsonWrite } from \"./global/utils\"\n\nconst pool = mysql.createPool(Conf)\n\nconst getAll = (res, type) => {\n    pool.getConnection((err, con) => {\n        con.query(Map[type], (err, result) => {\n            jsonWrite(res, result)\n            con.release()\n        })\n    })\n}\n\nexport default {\n    // fetch all article list\n    fetchAllArticle(req, res) {\n        getAll(res, \"getAllArticle\")\n    },\n    // fetch all message\n    fetchAllMessage(req, res) {\n        getAll(res, \"getAllMessage\")\n    },\n    // insert message\n    insertMessage(req, res) {\n        let data = req.body\n        let params = [data.name, data.content, data.response]\n\n        pool.getConnection((err, con) => {\n            con.query(Map.insertMessage, params, (err, result) => {\n                jsonWrite(res, result)\n                con.release()\n            })\n        })\n    }\n}\n"]}
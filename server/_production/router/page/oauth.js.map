{"version":3,"sources":["../../../app/router/page/oauth.js"],"names":[],"mappings":";;;;;;;;;;;;;;;AAOA;;;;AACA;;AACA;;;;kBAEe,eAAO;AAClB,QAAI,GAAJ,CAAQ,eAAR,EAAyB,UAAC,GAAD,EAAM,GAAN,EAAc;AACnC,YAAM,QAAQ;AACV,iBAAK,6CADK;AAEV,uBAAW,sBAFD;AAGV,2BAAe,0CAHL;AAIV,kBAAM,IAAI,KAAJ,CAAU,IAJN;AAKV,0BAAc;AALJ,SAAd;AAOA,+BAAQ,+BAAmB,KAAnB,CAAR,EAAmC,UAAC,GAAD,EAAM,QAAN,EAAgB,IAAhB,EAAyB;AACxD,mBAAO,4BAAgB,IAAhB,CAAP;AACA,gBAAM,QAAQ;AACZ,qBAAK,8CAA8C,KAAK,YAD5C;AAEZ,yBAAS;AACP,kCAAc;AADP;AAFG,aAAd;AAMA,mCAAQ,KAAR,EAAe,UAAC,GAAD,EAAM,QAAN,EAAgB,IAAhB,EAAyB;AACpC,uBAAO,KAAK,KAAL,CAAW,IAAX,CAAP;AACA,wBAAQ,GAAR,CAAY,IAAZ,SAAyB,IAAzB,yCAAyB,IAAzB;AACA,oBAAG,CAAC,KAAK,OAAT,EAAkB,yBAAa,IAAb;AAClB,oBAAI,QAAJ,CAAa,uBAAb;AACH,aALD;AAMH,SAdD;AAeH,KAvBD;AAwBH,C","file":"oauth.js","sourcesContent":["/*\n* @Author: woolson\n* @Date:   2016-12-16 00:31:52\n* @Email:   woolson.lee@gmail.com\n* @Last Modified by:   woolson\n* @Last Modified time: 2016-12-16 17:49:18\n*/\nimport request from \"request\"\nimport { fetchUrlwithParams, getParamFromStr } from \"../../global/utils\"\nimport { insertGithub } from \"../../handle/oauth\"\n\nexport default app => {\n    app.get(\"/oauth/github\", (req, res) => {\n        const param = {\n            url: \"https://github.com/login/oauth/access_token\",\n            client_id: \"72e5cae736efb0366ffc\",\n            client_secret: \"3a1efa6bdab27ec200828acacbe4ee83a6937026\",\n            code: req.query.code,\n            redirect_uri: \"http://www.woolson.cn/oauth/github/accessed\"\n        }\n        request(fetchUrlwithParams(param), (err, response, body) => {\n            body = getParamFromStr(body)\n            const param = {\n              url: \"https://api.github.com/user?access_token=\" + body.access_token,\n              headers: {\n                \"User-Agent\": \"woolson's website\",\n              }\n            }\n            request(param, (err, response, body) => {\n                body = JSON.parse(body)\n                console.log(body, typeof body)\n                if(!body.message) insertGithub(body)\n                res.redirect(\"http://www.baidu.com/\")\n            })\n        })\n    })\n}"]}